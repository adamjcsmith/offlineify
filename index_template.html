<!doctype html>
<!-- <html manifest="appcache/offlinify.appcache"> -->
<html>

  <head>
    <title>Offline Application</title>
    <link rel="stylesheet" href="css/semantic.min.css">
    <link rel="icon" type="image/ico" href="icon.ico">
    <style> .off { opacity: 0.75; }</style>
  </head>

  <body ng-app="offlineApp">

    <div ng-controller="mainCtrl">

      <div class="ui stackable menu">
        <div class="header item"><h3>Offline Engine</h3></div>
        <a class="item" ng-click="forceRefresh()"><i class="ui refresh icon"></i> Force Refresh</a>
        <div class="right menu">
          <div class="item">
            <form class="ui inverted action input" ng-submit="objectUpdate(candidateItem)">
              <input type="text" ng-model="candidateItem.fields.text" placeholder="Enter a new item">
              <button class="ui button" type="submit">Create</button>
            </form>
          </div>
        </div>
      </div>

      <div class="ui centered grid">

        <div class="row"></div>

        <div class="row">
          <div class="ui info message">
            <i class="close icon"></i>
            <div class="header">Your content will go here.</div>
            <p></p>
            <p>Objects are written to IndexedDB automatically. The app will
              synchronise every ten seconds, checking an API for new data.
              Alter the parameters in js/services/offlineDB.js to your API.</p>
            <p>Note: To make your app truly offline-capable, integrate this with <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Using_the_application_cache">AppCache</a>.</p>
          </div>
        </div>

        <div class="row"></div>

        <div class="row">
          <div class="fourteen wide column">

            <div class="ui cards">
              <div ng-class="{'card': true, 'off': !item.fields.clicked}" ng-hide="item.fields.deleted" ng-repeat="item in dataModel">
                <div class="content">
                  <i class="close link right floated icon" ng-click="item.fields.deleted = true"></i>
                  <div class="header">{{ item.fields.text }}</div>
                  <div class="meta">
                    <h6>{{item.pk}}</h6>
                  </div>
                </div>
                <div class="extra content">
                  <div class="ui two buttons">
                    <div class="ui grey button" ng-click="item.fields.clicked = false; objectUpdate(item)" ng-class="{'basic' : item.fields.clicked}">Off</div>
                    <div class="ui button" ng-click="item.fields.clicked = true; objectUpdate(item)" ng-class="{'basic' : !item.fields.clicked, 'teal' : item.fields.clicked, 'grey' : !item.fields.clicked}">On</div>
                  </div>
                </div>
              </div>
            </div>

          </div>
        </div>
        <div class="row"></div>
      </div>

  </div>

    <script src="lib/angular.min.js"></script>
    <script src="lib/jquery.min.js"></script>
    <script src="lib/notify.min.js"></script>
    <script src="lib/indexeddbpolyfill.min.js"></script>
    <script src="lib/lodash.js"></script>

    <script src="css/semantic.min.js"></script>

    <script src="js/app.js"></script>
    <script src="js/controllers/mainCtrl.js"></script>
    <script src="js/services/offlineDB.js"></script>
    <script src="js/directives/card.js"></script>

    <script>
    $('.message .close')
      .on('click', function() {
        $(this)
          .closest('.message')
          .transition('fade')
        ;
      });
    </script>

  </body>
</html>
